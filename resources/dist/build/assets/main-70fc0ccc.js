function _(i,t,e,d,a,l,r,u){var s=typeof i=="function"?i.options:i;t&&(s.render=t,s.staticRenderFns=e,s._compiled=!0),d&&(s.functional=!0),l&&(s._scopeId="data-v-"+l);var n;if(r?(n=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),a&&a.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(r)},s._ssrRegister=n):a&&(n=u?function(){a.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:a),n)if(s.functional){s._injectStyles=n;var c=s.render;s.render=function(h,f){return n.call(f),c(h,f)}}else{var m=s.beforeCreate;s.beforeCreate=m?[].concat(m,n):[n]}return{exports:i,options:s}}const C={mixins:[Fieldtype],data(){var i,t,e,d,a,l,r,u,s,n,c;return{data:{imageFile:{url:((t=(i=this.value)==null?void 0:i.imageFile)==null?void 0:t.url)||null,id:((d=(e=this.value)==null?void 0:e.imageFile)==null?void 0:d.id)||null,fileName:((l=(a=this.value)==null?void 0:a.imageFile)==null?void 0:l.fileName)||null,alt:((u=(r=this.value)==null?void 0:r.imageFile)==null?void 0:u.alt)||null,error:((n=(s=this.value)==null?void 0:s.imageFile)==null?void 0:n.error)||null},hotspots:((c=this.value)==null?void 0:c.hotspots)||[]}}},mounted(){this.config.max_files=1,this.config.min_files=0,this.config.mode="list"},watch:{data:{deep:!0,handler(){this.update(this.data)}}},computed:{imageFileId(){return this.data.imageFile.id?[this.data.imageFile.id]:[]},fields(){return this.config.fields}},methods:{imageFileClear(){this.data.imageFile={url:null,id:null,fileName:null,error:null}},updateImageFile(i){const t=["jpg","jpeg","png","gif","svg"];i[0]&&this.$axios.post(this.cpUrl("assets-fieldtype"),{assets:[i[0]]}).then(e=>{t.includes(e.data[0].extension)?this.data.imageFile={url:e.data[0].url,id:e.data[0].id,fileName:e.data[0].basename,alt:e.data[0].values.alt}:this.data.imageFile={error:"Invalid file type"}})},addHotspot(){let i=JSON.parse(JSON.stringify(this.meta.defaults));this.data.hotspots.push({x:50,y:50,content:{...i}})},dragStart(i,t){const e=this.data.hotspots[i],d=t.clientX,a=t.clientY,l=e.x,r=e.y,u=n=>{const c=this.$refs.image.getBoundingClientRect(),m=48,o=(c.width-m)/c.width*100,h=(c.height-m)/c.height*100,f=100-o,p=100-h,v=Math.min(o,Math.max(f,l+(n.clientX-d)/c.width*100)),g=Math.min(h,Math.max(p,r+(n.clientY-a)/c.height*100));e.x=v,e.y=g},s=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",s)},cpUrl(i){return i=Statamic.$config.get("cpUrl")+"/"+i,i.replace(/([^:])(\/\/+)/g,"$1/")},updated(i,t,e){this.data.hotspots[t].content[i]=e},metaUpdated(i,t){let e=clone(this.meta.metas);e[i]=t,this.$emit("meta-updated",e)},fieldPath(i,t){return`${this.name}.hotspots.${t}.content.${i}`},errors(i,t){const e=this.$store.state.publish[this.storeName];return e?e.errors[this.fieldPath(i,t)]||[]:[]}}};var y=function(){var t=this,e=t._self._c;return e("div",[t.data.imageFile.url?e("div",[e("div",{staticClass:"i-flex i-my-4 i-justify-between i-items-center i-p-4"},[e("p",{staticClass:"i-text-sm"},[t._v("Selected image:")]),e("div",{staticClass:"i-flex i-items-center i-gap-2"},[e("p",{staticClass:"i-text-sm"},[t._v(t._s(t.data.imageFile.fileName))]),e("button",{on:{click:t.imageFileClear}},[t._v("Ã—")])])])]):e("assets-fieldtype",{ref:"assets",staticClass:"assets-fieldtype",attrs:{value:t.imageFileId,handle:"assets",config:t.config,readOnly:t.readOnly},on:{input:t.updateImageFile}}),t.data.imageFile.error?e("div",{staticClass:"d-text-red-500"},[t._v(" "+t._s(t.data.imageFile.error)+" ")]):t._e(),t.data.imageFile.url?e("div",[e("div",{staticClass:"i-relative"},[e("div",{staticClass:"i-absolute i-w-full i-h-full i-border-red-500 i-border-opacity-25 i-border-[48px]"}),e("img",{ref:"image",staticClass:"i-w-full i-h-auto i-select-none",attrs:{src:t.data.imageFile.url}}),t._l(t.data.hotspots,function(d,a){return e("div",{key:a,staticClass:"i-absolute i-cursor-move -i-translate-x-[12px] -i-translate-y-[12px]",style:{top:d.y+"%",left:d.x+"%"},on:{mousedown:function(l){return t.dragStart(a,l)}}},[e("div",{staticClass:"i-w-6 i-h-6 i-bg-blue-500 i-border-white i-border-2 i-rounded-full i-flex i-justify-center i-items-center i-text-xs"},[t._v(" "+t._s(a)+" ")])])})],2),e("div",{staticClass:"i-mt-2 i-w-full"},[e("div",{staticClass:"i-grid i-gap-2"},t._l(t.data.hotspots,function(d,a){return e("div",{key:a,staticClass:"flex gap-2 items-center"},[e("div",{staticClass:"replicator-set w-full"},[e("div",{staticClass:"replicator-set-header"},[e("span",{staticClass:"text-xs rtl:ml-2 ltr:mr-2 p-2 whitespace-nowrap"},[t._v(" Hotspot "+t._s(a)+" ")]),e("div",{staticClass:"py-2 rtl:pr-2 ltr:pl-2 replicator-set-header-inner flex justify-end items-end w-full"},[e("button",{staticClass:"flex self-end group items-center",attrs:{"aria-label":t.__("Delete Row")},on:{click:function(l){return t.data.hotspots.splice(a,1)}}},[e("svg-icon",{staticClass:"w-4 h-4 text-gray-600 group-hover:text-gray-900",attrs:{name:"micro/trash"}})],1)])]),e("div",{staticClass:"replicator-set-body publish-fields @container"},t._l(t.fields,function(l){return e("set-field",{key:l.handle,staticClass:"p-4",attrs:{field:l,meta:t.meta.metas[l.handle],value:d.content[l.handle],"parent-name":t.name,"set-index":a,errors:t.errors(l.handle,a),"field-path":t.fieldPath(l.handle,a)},on:{updated:function(r){return t.updated(l.handle,a,r)},"meta-updated":function(r){return t.metaUpdated(l.handle,r)},focus:function(r){return t.$emit("focus")},blur:function(r){return t.$emit("blur")}}})}),1)])])}),0)]),e("div",{staticClass:"i-mt-2"},[e("button",{staticClass:"btn",on:{click:t.addHotspot}},[t._v("Add Hotspot")])])]):e("div",{staticClass:"i-flex i-justify-between i-items-center"},[e("p",{staticClass:"i-mt-2 i-text-sm"},[t._v("Select an image")])])],1)},F=[],b=_(C,y,F,!1,null,null,null,null);const $=b.exports;Statamic.$components.register("image_hot_spots-fieldtype",$);
